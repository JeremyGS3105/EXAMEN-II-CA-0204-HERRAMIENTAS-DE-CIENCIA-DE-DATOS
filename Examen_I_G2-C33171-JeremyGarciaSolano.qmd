---
title: "II PARCIAL"
author: "JEREMY GARCIA SOLANO C33171"
date: "30-12-2025"
subtitle: "HERRAMIENTAS DE CIENCIA DE DATOS"
institute: "UNIVERSIDAD DE COSTA RICA"
titlepage: TRUE
format:
  html: 
    embed-resources: TRUE
---

## Carga de paquetes

```{r}
library(readr)
library(tidyverse)
library(DescTools)
library(rpart)
library(rpart.plot)
```

## Importar base de datos

```{r}
moras <- read.csv("C:/Users/jereg/Downloads/moras.txt")

moras$SALARIO <- gsub(",", ".", moras$SALARIO) #Cambia las comas por puntos
moras$SALARIO <- as.numeric(moras$SALARIO)
```

## 2.Resumen de 5 números

```{r}
moras %>% 
  select(SALARIO,EDAD) %>% 
  summary()
```

## 3. Nueva columna con Z-SCORE

```{r,eval=FALSE}
llenar_NA <- function(df){
  df[df == ""] <- NA
  return(df)
}
moras<-llenar_NA(moras)
  

moras <- moras %>% 
  mutate(
    Z_EDAD =  abs((EDAD - mean(EDAD,na.rm=TRUE)) / sd(EDAD,na.rm=TRUE)),
    CLASIFICACIÓN_EDAD = ifelse(Z_EDAD>1.96,"ATÍPICO","NORMAL"),
    Z_SALARIO =  abs((SALARIO - mean(SALARIO,na.rm=TRUE)) / sd(SALARIO,na.rm=TRUE)),
    CLASIFICACIÓN_SALARIO = ifelse(Z_SALARIO>1.96,"ATÍPICO","NORMAL")
  )
```

```{r}
head(moras)
```

## 4.Calcular el % de NA por columna

```{r}
colSums(is.na(moras)) / nrow(moras) * 100
```


## 5.Imputar NA´s

```{r}
moras$SALARIO[is.na(moras$SALARIO)] <- median(moras$SALARIO, na.rm = TRUE) #Se imputa la mediana ya que es menos influenciada por los outliers

moras$EDAD[is.na(moras$EDAD)] <- median(moras$EDAD, na.rm = TRUE) #Se imputa la mediana ya que es menos influenciada por los outliers

moras$TIPO_ASEGURAMIENTO[is.na(moras$TIPO_ASEGURAMIENTO)] <- Mode(moras$TIPO_ASEGURAMIENTO,na.rm=TRUE) #Se imputa la moda

```

## 6. Gráficos por variable

```{r}
variables_categoricas <- c("SEXO","TIPO_ASEGURAMIENTO",
"SECTOR","INDICADOR_ACTIVO","INDICADOR.EXTRANJERO","INDICADOR_MOROSO")

graficar_categorias <- function(df, variable) {
  ggplot(df, aes(x = .data[[variable]])) +
    geom_bar(fill = "skyblue") +
    labs(
      title = paste("Cantidad de individuos por", variable),
      x = variable,
      y = "Conteo"
    ) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
}

for (j in variables_categoricas) {
  print(graficar_categorias(moras, j))
}
```

**Gráfico de SEXO:** Vemos que en la base de datos hay más hombres que mujeres\
**Gráfico de TIPO_DE_ASEGURAMIENTO:** La mayor concentración de personas está en los asalariados y la menor cantidad está dentro de los convenios especiales.\
**Gráfico por SECTOR:** Se puede notar una gran diferencia entre ambos sectores, hay mas concentracion en el sector privado que en el público\
**Gráfico de INDICADOR_ACTIVO:** La mayor parte de las personas, aún cuentan con un seguro activo.\
**Gráfico por INDICADOR.EXTRANJERO:** Se puede difrenciar la cantidad de personas nacionales y extranjeras dentro de la base de datos.\
**Gráfico por INDICADOR_MOROSO** **:** Hay más personas NO morosas que morosas,\